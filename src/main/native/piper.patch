diff --git a/libpiper/include/piper_impl.hpp b/libpiper/include/piper_impl.hpp
index aa12a1d..186d297 100644
--- a/libpiper/include/piper_impl.hpp
+++ b/libpiper/include/piper_impl.hpp
@@ -35,7 +35,7 @@ const float DEFAULT_NOISE_W_SCALE = 0.8f;
 const int DEFAULT_HOP_LENGTH = 256;
 
 // onnx
-Ort::Env ort_env{ORT_LOGGING_LEVEL_WARNING, "piper"};
+extern Ort::Env ort_env;
 
 // espeak
 #define CLAUSE_INTONATION_FULL_STOP 0x00000000
@@ -87,7 +87,7 @@ struct piper_synthesizer {
 };
 
 // Get the first UTF-8 codepoint of a string
-std::optional<Phoneme> get_codepoint(std::string s) {
+inline std::optional<Phoneme> get_codepoint(std::string s) {
     auto view = una::views::utf8(s);
     auto it = view.begin();
 
diff --git a/libpiper/src/piper.cpp b/libpiper/src/piper.cpp
index 774e87d..9b7dde6 100644
--- a/libpiper/src/piper.cpp
+++ b/libpiper/src/piper.cpp
@@ -7,8 +7,15 @@
 
 #include <espeak-ng/speak_lib.h>
 
+#ifdef _WIN32
+#define NOMINMAX
+#include <windows.h>
+#endif
+
 using json = nlohmann::json;
 
+Ort::Env ort_env{ORT_LOGGING_LEVEL_WARNING, "piper"};
+
 struct piper_synthesizer *piper_create(const char *model_path,
                                        const char *config_path,
                                        const char *espeak_data_path) {
@@ -96,8 +103,18 @@ struct piper_synthesizer *piper_create(const char *model_path,
     synth->session_options.DisableMemPattern();
     synth->session_options.DisableProfiling();
 
-    synth->session = std::make_unique<Ort::Session>(
-        Ort::Session(ort_env, model_path, synth->session_options));
+    #ifdef _WIN32
+        // Windows: ONNX Runtime required wchar_t for file paths
+        int size_needed = MultiByteToWideChar(CP_UTF8, 0, model_path, -1, NULL, 0);
+        std::wstring model_path_w(size_needed, 0);
+        MultiByteToWideChar(CP_UTF8, 0, model_path, -1, &model_path_w[0], size_needed);
+        synth->session = std::make_unique<Ort::Session>(
+            Ort::Session(ort_env, model_path_w.c_str(), synth->session_options));
+    #else
+        // Linux/macOS: ONNX Runtime uses standard char
+        synth->session = std::make_unique<Ort::Session>(
+            Ort::Session(ort_env, model_path, synth->session_options));
+    #endif
 
     return synth;
 }
